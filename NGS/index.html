<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>NGS - software notes</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">

        <script src="../js/jquery-1.10.2.min.js" defer></script>
        <script src="../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/Bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/HTML.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/Java.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/JavaScript.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/Perl.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/Python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/R.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/rust.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">software notes</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home</a>
                            </li>
                            <li class="navitem">
                                <a href="../AA/" class="nav-link">Association</a>
                            </li>
                            <li class="navitem">
                                <a href="../AI/" class="nav-link">AI</a>
                            </li>
                            <li class="navitem">
                                <a href="../CRISPR/" class="nav-link">CRISPR</a>
                            </li>
                            <li class="navitem active">
                                <a href="./" class="nav-link">NGS</a>
                            </li>
                            <li class="navitem">
                                <a href="../SL/" class="nav-link">SL</a>
                            </li>
                            <li class="navitem">
                                <a href="../misc/" class="nav-link">misc</a>
                            </li>
                            <li class="navitem">
                                <a href="../pharmacogenomics/" class="nav-link">Pharmacogenomics</a>
                            </li>
                            <li class="navitem">
                                <a href="../scRNASeq/" class="nav-link">scRNASeq</a>
                            </li>
                            <li class="navitem">
                                <a href="../prottrans/" class="nav-link">prottrans</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../CRISPR/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" href="../SL/" class="nav-link">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#benchmarks-and-pipelines" class="nav-link">Benchmarks and pipelines</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#review" class="nav-link">Review</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#ngs-pipeline" class="nav-link">NGS pipeline</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#annotation" class="nav-link">Annotation</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#case-studies" class="nav-link">Case studies</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#agotron-detection" class="nav-link">Agotron detection</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#alignment-and-variant-calling-tutorial" class="nav-link">Alignment and variant calling tutorial</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#bowtie-scaling" class="nav-link">bowtie-scaling</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#exome-sequencing-analysis" class="nav-link">Exome sequencing analysis</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#cnv-detection" class="nav-link">CNV detection</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#snp-discovery" class="nav-link">SNP discovery</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#tss" class="nav-link">TSS</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#comparison-of-gene-expression-pipelines-on-rna-seq-sequencing-data" class="nav-link">Comparison of gene expression pipelines on RNA-seq sequencing data.</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#gsnap-mapsplice-rum-star-rna-seq-pipeline" class="nav-link">GSNAP, MapSplice, RUM, STAR, RNA-seq pipeline</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#mendelian-rna-seq" class="nav-link">Mendelian RNA-seq</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#sra-toolkit-tophat" class="nav-link">sra-toolkit, tophat</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#software" class="nav-link">Software</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#advntr" class="nav-link">adVNTR</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#angsd" class="nav-link">ANGSD</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#ubuntu-archive-bamtools-bcftools-bedops-bedtools-blast-ncbi-blast-bowtie2-fastqc-fastx-toolkit-freebayes-hmmer-hisat2-picard-tools-rsem-sambamba-samtools-seqtk-sra-toolkit-subread-tophat-trinityrnaseq-vcftool-vowpal-wabbit" class="nav-link">Ubuntu archive: bamtools, bcftools, bedops, bedtools, blast (ncbi-blast+), bowtie2, fastqc, fastx-toolkit, freebayes, hmmer, hisat2, picard-tools, rsem, sambamba, samtools, seqtk, sra-toolkit, subread, tophat, trinityrnaseq, vcftool, vowpal-wabbit</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#bcftools" class="nav-link">bcftools</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#bowtie2" class="nav-link">bowtie2</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#cnvkit" class="nav-link">CNVkit</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#cutadapt-trimgalore" class="nav-link">cutadapt, TrimGalore</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#deepvariant" class="nav-link">DeepVariant</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#easyqc" class="nav-link">EasyQC</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#exomiser" class="nav-link">Exomiser</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#fastq-splitter" class="nav-link">fastq-splitter</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#fastx_toolkit-rsem" class="nav-link">fastx_toolkit, RSEM</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#freebayes" class="nav-link">freebayes</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#gatk" class="nav-link">GATK</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#hisat2-sambamba-picard-tools-stringtie" class="nav-link">hisat2, sambamba, picard-tools, StringTie</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#igv" class="nav-link">IGV</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#jannovar" class="nav-link">Jannovar</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#melissa" class="nav-link">Melissa</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#monster" class="nav-link">MONSTER</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-level="1"><a href="#pindel" class="nav-link">pindel</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#rtg-tools" class="nav-link">rtg-tools</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#sambamba" class="nav-link">sambamba</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#samtools" class="nav-link">samtools</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#snpeff-snpsift-clineff" class="nav-link">SnpEff, SnpSift, clinEff</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#subread" class="nav-link">subread</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#svict" class="nav-link">SViCT</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#tagdust" class="nav-link">tagdust</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#trinity" class="nav-link">Trinity</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#varscan" class="nav-link">VarScan</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#vcftools" class="nav-link">vcftools</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#wasp" class="nav-link">WASP</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="benchmarks-and-pipelines">Benchmarks and pipelines</h1>
<h2 id="review">Review</h2>
<p>Pabinger S, et al. (2014). A survey of tools for variant analysis of next-generation genome sequencing data. <em>Brief Bioinformatics</em> 15(2):256-278.</p>
<h2 id="ngs-pipeline">NGS pipeline</h2>
<p>https://www.hgsc.bcm.edu/software/mercury</p>
<h2 id="annotation">Annotation</h2>
<p>https://sites.google.com/site/jpopgen/wgsa</p>
<h2 id="case-studies">Case studies</h2>
<p>Lagana A, et al. (2018). Precision medicine for relapsed multiple myeloma on the basis of an integrative multiomics approach. <em>JCO Prec Oncol.</em> Data Suppl, 
http://ascopubs.org/doi/suppl/10.1200/PO.18.00019</p>
<p>Lu X-M, et al. (2018). Association of breast and ovarian cancers with predisposition genes identified by large-scale sequencing. <em>JAMA Oncol</em>, doi:10.1001/jamaoncol.2018.2956.</p>
<p>Mestek-Boukhibar L, et al. (2018). Rapid Paediatric Sequencing (RaPS): comprehensive real-life workflow for rapid diagnosis of critically ill children. <em>J Med Genet</em>, doi:10.1136/jmedgenet-2018-105396</p>
<p>Castel SE, et al. (2018). Modified penetrance of coding variants by cis-regulatory variation contributes to disease risk.<em>Nat Genet</em>, https://doi.org/10.1038/s41588-018-0192-y.</p>
<p>Dixon JR, et al. (2018). Integrative detection and analysis of structural variation in cancer genomes. <em>Nat Genet</em>, https://www.nature.com/articles/s41588-018-0195-8</p>
<p>Wood DE, et al. (2018). A machine learning approach for somatic mutation discovery. Sci. Transl. Med. 10, eaar7939 (2018) DOI: 10.1126/scitranslmed.aar7939</p>
<h2 id="agotron-detection">Agotron detection</h2>
<p>The following is according to https://github.com/ncrnalab/agotron_detector as described in</p>
<blockquote>
<p>Hansen TB (2018). Detecting Agotrons in Ago CLIPseq Data. in Vang Ã˜rom UA (ed) miRNA Biogenesis-Methods and Protocols, Chapter 17, 221-232. Springer.</p>
</blockquote>
<pre><code class="language-bash">wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/bigZips/chromFa.tar.gz
tar -zxvf chromFa.tar.gz
cat *.fa &gt; hg19.fa
samtools faidx hg19.fa
bowtie2-build hg19.fa hg19
# GSE78059
for srr in 008/SRR3177718/SRR3177718 009/SRR3177719/SRR3177719 000/SRR3177720/SRR3177720 001/SRR3177721/SRR3177721 002/SRR3177722/SRR3177722 003/SRR3177723/SRR3177723
do
   wget ftp.sra.ebi.ac.uk/vol1/fastq/SRR317/$srr.fastq.gz
done
trim_galore -A TCAGTCACTTCCAGC -length 18 *.fastq.gz
for i in *_trimmed.fq.gz
do
    echo $i
    bowtie2 -q --local -x hg19 -U $i | samtools sort - &gt; $i.sort.bam    
    samtools index $i.sort.bam

done
python UCSC_intron_retriever.py | python analyzer.py -g hg19.fa | Rscript annotater.R
</code></pre>
<p>Note that it is easier to implement with <code>prefetch</code> as shown below.</p>
<h2 id="alignment-and-variant-calling-tutorial">Alignment and variant calling tutorial</h2>
<p>See https://github.com/ekg/alignment-and-variant-calling-tutorial. Note that E.coli_K12_MG1655.fa is unavailable any more, instead we have to download it directly from NCBI, 
https://www.ncbi.nlm.nih.gov/nuccore/556503834, choose FASTA (text), to reach https://www.ncbi.nlm.nih.gov/nuccore/NC_000913.3?report=fasta&amp;log$=seqview&amp;format=text and save
to a local file, whose empty lines have to be removed, see them with awk '(length($NF)==0){print NR}' E.coli_K12_MG1655.fa.</p>
<p>The fastq-dump generates .fa files, which need to be compressed with gzip.</p>
<h2 id="bowtie-scaling">bowtie-scaling</h2>
<p>https://github.com/BenLangmead/bowtie-scaling</p>
<h2 id="exome-sequencing-analysis">Exome sequencing analysis</h2>
<blockquote>
<p>IMSGC (2018). Low-frequency and rare-coding variation contributes to multiple sclerosis risk. <em>Cell</em>. DOI:https://doi.org/10.1016/j.cell.2018.09.049</p>
</blockquote>
<p>has associate software, https://github.com/cotsapaslab/IMSGCexomechip.</p>
<h2 id="cnv-detection">CNV detection</h2>
<p>CN-Learn is a framework to integrate Copy Number Variant (CNV) predictions made by multiple algorithms using exome sequencing datasets.</p>
<p>https://github.com/girirajanlab/CN_Learn</p>
<p>Pounraja VK, et al. (2019) A machine-learning approach for accurate detection of copy-number variants from exome sequencing. <em>Genome Res</em>.</p>
<h2 id="snp-discovery">SNP discovery</h2>
<p>The following reference discribes several pipelines for SNP discovery.</p>
<blockquote>
<p>Morin PA, Foote AD, Hill CM, Simon-Bouhet B, Lang AR, Louis M (2018). SNP Discovery from Single and Multiplex Genome Assemblies of Non-model Organisms, in Head SR, et al. (eds.), Next Generation Sequencing: Methods and Protocols, Chapter 9, 113-144, Springer.</p>
</blockquote>
<p>whose scripts are available from https://github.com/PAMorin/SNPdiscovery/.</p>
<p>See also https://github.com/sanger-pathogens/snp-sites and the following references,</p>
<blockquote>
<p>Martin J, Schackwitz W, Lipzen A (2018). Genomic Sequence Variation Analysis by Resequencing, in de Vries RP, Tsang A, Grigoriev IV (ed) Fungal Genomics-Methods and Protocols, 2e, Chapter 18, 229-239, Springer.</p>
<p>Raghavachari N, Garcia-Reyero N (eds.) (2018), Gene Expression Analysis-Methods and Protocols, Springer.</p>
</blockquote>
<h2 id="tss">TSS</h2>
<p>Mejia-Guerra MK, et al. (2018). Genome-Wide TSS Identification in Maize. Chapter 14, 239-256, in Yamaguchi N (ed.), Plant Transcription Factors-Methods and Protocols, Springer</p>
<h2 id="comparison-of-gene-expression-pipelines-on-rna-seq-sequencing-data">Comparison of gene expression pipelines on RNA-seq sequencing data.</h2>
<p>http://statapps.ugent.be/tools/AppDGE/</p>
<h2 id="gsnap-mapsplice-rum-star-rna-seq-pipeline">GSNAP, MapSplice, RUM, STAR, RNA-seq pipeline</h2>
<pre><code class="language-bash"># gsnap
wget http://research-pub.gene.com/gmap/src/gmap-gsnap-2018-07-04.tar.gz
tar xfz gmap-gsnap-2018-07-04.tar.gz
cd gmap-2018-07-04
./configure
make
sudo make install
# mapsplice, the latest version from http://protocols.netlab.uky.edu/~zeng/MapSplice-v2.2.1.zip has compiling issue
sudo `which conda` install mapsplice
mapsplice.py
# rum
git clone https://github.com/itmat/rum
cd rum
perl Makefile.PL
make
sudo make install
# STAR
git clone https://github.com/alexdobin/STAR
cd STAR/source
make
</code></pre>
<p>See https://github.com/sanger-pathogens/Bio-RNASeq for RNA-seq pipeline.</p>
<h2 id="mendelian-rna-seq">Mendelian RNA-seq</h2>
<p>https://github.com/komalsrathi/MendelianRNA-seq</p>
<p>The relevant installations:</p>
<pre><code>conda create --name mendelian-rnaseq-env
source activate mendelian-rnaseq-env
conda install -c bioconda snakemake
conda install -c bioconda rna-seqc
conda install -c bioconda gatk
conda install -c biobuilds plink
conda install -c bioconda star
conda install -c bioconda picard
conda install -c bioconda bwa
conda install -c anaconda colorama
conda install -c bioconda misopy
</code></pre>
<h2 id="sra-toolkit-tophat">sra-toolkit, tophat</h2>
<p>These are very straightforward, e.g.,</p>
<pre><code class="language-bash">prefetch -v SRR3534842
fastq-dump --split-files --gzip SRR3534842
</code></pre>
<p>the SRR3534842.sra from prefetch is actually at $HOME/ncbi/public/sra which is split into <code>SRR3534842_1.fastq.gz</code>, <code>SRR3534842_2.fastq.gz</code> at the current directory. See https://www.biostars.org/p/111040/. However, the location may not desirable since it may create a huge .vdi files with VirtualBox -- to get around we do this</p>
<pre><code class="language-bash">cd $HOME
mkdir -p /home/jhz22/D/work/ncbi/public/sra
ln -sf /home/jhz22/D/work/ncbi
</code></pre>
<p>where D is actually a shared folder at Windows.</p>
<p>To run <code>tophat</code>, see https://ccb.jhu.edu/software/tophat/tutorial.shtml</p>
<pre><code class="language-bash">wget https://ccb.jhu.edu/software/tophat/downloads/test_data.tar.gz
tar xvfz test_data.tar.gz
cd test_data
tophat -r 20 test_ref reads_1.fq reads_2.fq
</code></pre>
<h1 id="software">Software</h1>
<h2 id="advntr">adVNTR</h2>
<p>It is a tool for genotyping Variable Number Tandem Repeats (VNTR) from sequence data, https://github.com/mehrdadbakhtiari/adVNTR.</p>
<h2 id="angsd">ANGSD</h2>
<p>ANGSD is a software for analyzing next generation sequencing data, http://www.popgen.dk/angsd/index.php/ANGSD. It is relatively straightforward with GitHub; after</p>
<pre><code class="language-bash">git clone https://github.com/ANGSD/angsd
cd angsd
make
</code></pre>
<p>but the following change is needed on line 468 of <code>misc/msHOT2glf.c</code>: <code>tmppch</code> as in (tmppch=='\0') should be <code>*tmppch</code> as in <code>(*tmppch==''0')</code>, suggested by the compiler.</p>
<h2 id="ubuntu-archive-bamtools-bcftools-bedops-bedtools-blast-ncbi-blast-bowtie2-fastqc-fastx-toolkit-freebayes-hmmer-hisat2-picard-tools-rsem-sambamba-samtools-seqtk-sra-toolkit-subread-tophat-trinityrnaseq-vcftool-vowpal-wabbit">Ubuntu archive: bamtools, bcftools, bedops, bedtools, blast (ncbi-blast+), bowtie2, fastqc, fastx-toolkit, freebayes, hmmer, hisat2, picard-tools, rsem, sambamba, samtools, seqtk, sra-toolkit, subread, tophat, trinityrnaseq, vcftool, vowpal-wabbit</h2>
<p>Install with <code>sudo apt install</code>.</p>
<p>See also https://github.com/lh3/seqtk.</p>
<p>Besides notes above, this is also possible:</p>
<h2 id="bcftools">bcftools</h2>
<pre><code class="language-bash">wget https://github.com/samtools/bcftools/releases/download/1.9/bcftools-1.9.tar.bz2
tar jfx bcftools-1.9.tar.bz2
cd bcftools-1.9
./configure --prefix=$HPC_WORK
make
make install
</code></pre>
<p>It is necessary to set the environment variables to enable plugins, so we could generate a version at $HPC_WORK/bin instead,</p>
<pre><code class="language-bash">#!/usr/bin/bash

export BCFTOOLS_PLUGINS=$HPC_WORK/bcftools-1.9/plugins
$HPC_WORK/bcftools-1.9/bcftools &quot;$@&quot;
</code></pre>
<p>We invoke <code>bcftools +check_ploidy my.vcf.gz</code> Interestingly, this also save space!</p>
<h2 id="bowtie2">bowtie2</h2>
<p>The project home is https://sourceforge.net/projects/bowtie-bio, whereby</p>
<pre><code class="language-bash">wget https://sourceforge.net/projects/bowtie-bio/files/bowtie2/2.3.4.1/bowtie2-2.3.4.1-linux-x86_64.zip
wget https://sourceforge.net/projects/bowtie-bio/files/bowtie2/2.3.4.1/bowtie2-2.3.4.1-source.zip
unzip bowtie2-2.3.4.1-linux-x86_64.zip
cd bowtie2-2.3.4.1-linux-x86_64/
</code></pre>
<p>The test is then self-contained,</p>
<pre><code class="language-bash">export BT2_HOME=/home/jhz22/D/genetics/bowtie2-2.3.4.1-linux-x86_64

$BT2_HOME/bowtie2-build $BT2_HOME/example/reference/lambda_virus.fa lambda_virus
$BT2_HOME/bowtie2 -x lambda_virus -U $BT2_HOME/example/reads/reads_1.fq -S eg1.sam
$BT2_HOME/bowtie2 -x $BT2_HOME/example/index/lambda_virus -1 $BT2_HOME/example/reads/reads_1.fq -2 $BT2_HOME/example/reads/reads_2.fq -S eg2.sam

samtools view -bS eg2.sam &gt; eg2.bam
samtools sort eg2.bam -o eg2.sorted.bam
samtools mpileup -uf $BT2_HOME/example/reference/lambda_virus.fa eg2.sorted.bam | bcftools view -Ov - &gt; eg2.raw.bcf
bcftools view eg2.raw.bcf
</code></pre>
<p>Like samtools, etc. it is possible to involve <code>sudo apt install bowtie2</code>.</p>
<h2 id="cnvkit">CNVkit</h2>
<p>Genome-wide copy number from high-throughput sequencing, available from
https://cnvkit.readthedocs.io/en/stable/</p>
<h2 id="cutadapt-trimgalore">cutadapt, TrimGalore</h2>
<p>A prerequesite is to install cython.</p>
<pre><code class="language-bash">git clone https://github.com/marcelm/cutadapt
cd cutadapt
sudo python setup.py install
git clone https://github.com/FelixKrueger/TrimGalore
</code></pre>
<h2 id="deepvariant">DeepVariant</h2>
<p>It is a deep neural network to call genetic variants from next-generation DNA sequencing data, https://github.com/google/deepvariant.</p>
<h2 id="easyqc">EasyQC</h2>
<p>http://www.niot.res.in/EasyQC/</p>
<h2 id="exomiser">Exomiser</h2>
<pre><code class="language-bash">git clone https://github.com/exomiser/Exomiser
cd Exomiser
mvn package
</code></pre>
<p>See also https://github.com/exomiser/exomiser-demo.</p>
<h2 id="fastq-splitter">fastq-splitter</h2>
<p>The scripts divides a large FASTQ file into a set of smaller equally sized files, http://kirill-kryukov.com/study/tools/fastq-splitter/.</p>
<h2 id="fastx_toolkit-rsem">fastx_toolkit, RSEM</h2>
<p>It is also available from https://github.com/agordon/fastx_toolkit along with https://github.com/agordon/libgtextutils, and do away with the notorious automake-1.14 problem associated with sources at http://hannonlab.cshl.edu/fastx_toolkit/download.html.</p>
<p>However, line 105 of <code>src/fasta_formatter/fasta_formatter.cpp</code> requires <code>usage()</code> followed by <code>exit(0);</code> as suggested in the <code>issue</code> section. More oever, usage() is a void function so its own <code>exit(0)</code> is unnecessary.</p>
<p>The GitHub pages for RSEM are https://github.com/deweylab/RSEM and https://deweylab.github.io/RSEM/. It is also recommended that the Bioconductor package EBSeq be installed.</p>
<h2 id="freebayes">freebayes</h2>
<p>Try</p>
<pre><code class="language-bash">git clone --recursive https://github.com/ekg/freebayes
make
sudo make install
</code></pre>
<h2 id="gatk">GATK</h2>
<p>The source is available from https://github.com/broadinstitute/gatk/ but it is more convenient to use https://github.com/broadinstitute/gatk/releases/.</p>
<pre><code class="language-bash">ln -s `pwd`/gatk $HOME/bin/gatk
gatk --help
gatk --list
</code></pre>
<h2 id="hisat2-sambamba-picard-tools-stringtie">hisat2, sambamba, picard-tools, StringTie</h2>
<p>Except StringTie, this is overlapped with <code>apt install</code> above,</p>
<pre><code class="language-bash">brew tap brewsci/bio
brew tap brewsci/science
brew install hisat2
hisat2-build
brew install sambamba
brew install picard-tools
brew install stringtie
</code></pre>
<p>It could be useful with ``brew reinstall```. See</p>
<blockquote>
<p>Raghavachari N, Garcia-Reyero N (eds.) (2018), Gene Expression Analysis-Methods and Protocols, https://www.springer.com/us/book/9781493978335, Chapter 15, Springer.</p>
</blockquote>
<p>Nevertheless it may be slower, e.g., tophat, compared to <code>sudo apt install</code>.</p>
<h2 id="igv">IGV</h2>
<p>The download can be seeded from http://data.broadinstitute.org/igv, e.g., http://data.broadinstitute.org/igv/projects/downloads/2.4/IGV_2.4.10.zip.</p>
<p>Again the source code is from GitHub, https://github.com/igvteam/igv/. For developers, <a href="https://github.com/igvteam/igv.js">igv.js</a> is very appealing.</p>
<h2 id="jannovar">Jannovar</h2>
<p>From the GitHub repository, it is seen to use <code>project object model</code> (POM), an XML representation of a Maven project held in a file named <code>pom.xml</code>. We therefore install <code>maven</code> first,</p>
<pre><code class="language-bash">sudo apt install maven
</code></pre>
<p>The installation then proceeds as follows,</p>
<pre><code class="language-bash">git clone https://github.com/charite/jannovar
cd jannovar
mvn package
</code></pre>
<p>Other tasks such as compile, test, etc. are also possible.</p>
<p>It is handy to use symbolic link, i.e.,</p>
<pre><code class="language-bash">ln -s /home/jhz22/D/genetics/jannovar/jannovar-cli/target/jannovar-cli-0.24.jar $HOME/bin/Jannovar.jar
java -jar $HOME/bin/Jannovar.jar db-list
java -jar $HOME/bin/Jannovar.jar download -d hg19/refseq
</code></pre>
<p>We may need to set memory size, e.g., </p>
<pre><code class="language-bash">java -Xms2G -Xmx4G -jar $HOME/bin/Jannovar.jar
</code></pre>
<h1 id="melissa">Melissa</h1>
<p>https://github.com/andreaskapou/Melissa</p>
<blockquote>
<p>MEthyLation Inference for Single cell Analysis (Melissa), is a Bayesian hierarchical method to quantify spatially-varying methylation profiles across genomic regions from single-cell bisulfite sequencing data (scBS-seq). Melissa clusters individual cells based on local methylation patterns, enabling the discovery of epigenetic diversities and commonalities among individual cells. The clustering also acts as an effective regularisation method for imputation of methylation on unassayed CpG sites, enabling transfer of information between individual cells.</p>
</blockquote>
<p>Kapourani C-A, Sanguinetti G (2019). Melissa: Bayesian clustering and imputation of single-cell methylomes, <em>Genome Biology</em> 20:61, https://doi.org/10.1186/s13059-019-1665-8</p>
<h1 id="monster">MONSTER</h1>
<p>http://galton.uchicago.edu/~mcpeek/software/MONSTER/
http://galton.uchicago.edu/~mcpeek/software/MONSTER/MONSTER_v1.3.tar.gz</p>
<p>Jiang D, McPeek MS (2014). Robust Rare Variant Association Testing for Quantitative Traits in Samples with Related Individuals. <em>Genetic Epidemiology</em> 38(1):10-20</p>
<h1 id="pindel">pindel</h1>
<p>The software can be obtained from https://github.com/genome/pindel.</p>
<p>After htslib is installed, the canonical instruction is to issue</p>
<pre><code class="language-bash">git clone https://github.com/samtools/htslib
cd htslib
make
sudo make install
cd -
git clone https://github.com/genome/pindel
cd pindel
./INSTALL ../htslib
</code></pre>
<p>It is 'standard' to have complaints about pindel.cpp, bddate.cpp and genotyping.cpp,
for <code>abs()</code> rather than <code>fabs()</code> from the header file <code>cmath</code> have been used. The
issue goes away when <code>abs</code> is replaced with <code>fabs</code> and in the case of bddata.cpp,
it is also necessary to invoke the header, i.e.,</p>
<pre><code class="language-cpp">#include &lt;cmath&gt;
</code></pre>
<h2 id="rtg-tools">rtg-tools</h2>
<p>It is available from https://www.realtimegenomics.com/products/rtg-tools and GitHub,</p>
<pre><code class="language-bash">git clone https://github.com/RealTimeGenomics/rtg-tools.git
ant
dir dist
</code></pre>
<h2 id="sambamba">sambamba</h2>
<p>While the source contains ldc2, it is readily available with Ubuntu archive nevertheless failed to compile, 
so we proceed with instructions at the GitHub, e.g.,</p>
<pre><code class="language-bash">export PATH=$HOME/ldc2-1.10.0-linux-x86_64/bin:$PATH
export LIBRARY_PATH=$HOME/ldc2-1.10.0-linux-x86_64/lib
</code></pre>
<p>for version 1.10.0.</p>
<h2 id="samtools">samtools</h2>
<p>To build from source, we do these,</p>
<pre><code class="language-bash">git clone https://github.com/samtools/htslib
cd htslib
make
cd -
git clone https://github.com/samtools/samtools
cd samtools
autoheader            # Build config.h.in (this may generate a warning about
                      # AC_CONFIG_SUBDIRS - please ignore it).
autoconf -Wno-syntax  # Generate the configure script
./configure           # Needed for choosing optional functionality
make
make install
</code></pre>
<p>Note bgzip and tabix are distributed with htslib. It is relatively easier to install from release,</p>
<pre><code class="language-bash">wget https://github.com/samtools/samtools/releases/download/1.9/samtools-1.9.tar.bz2
tar xjf samtools-1.9.tar.gz
cd samtools-1.9
./configure --prefix=/scratch/jhz22
make
make install
cd -
cd htslib-1.9
./configure --prefix=/scratch/jhz22
make
make install
</code></pre>
<p>where we install tabix as well.</p>
<h2 id="snpeff-snpsift-clineff">SnpEff, SnpSift, clinEff</h2>
<p>It is straightforward with the compiled version from sourceforge, which also includes clinEff.</p>
<pre><code class="language-bash">wget http://sourceforge.net/projects/snpeff/files/snpEff_latest_core.zip
unzip snpEff_latest_core
cd snpEff
java -jar snpEff.jar databases
java -jar snpEff.jar download GRCh38.76
wget http://sourceforge.net/projects/snpeff/files/databases/test_cases.tgz
tar fvxz test_cases.tgz
</code></pre>
<p>lists all the databases and download a particular one. Later, the test files are also downloaded and extracted.</p>
<p>The following steps compile from source instead.</p>
<pre><code class="language-bash">git clone https://github.com/pcingola/SnpEff.git
cd SnpEff
mvn package
mvn install
cd lib
# Antlr
mvn install:install-file \
    -Dfile=antlr-4.5.1-complete.jar \
    -DgroupId=org.antlr \
    -DartifactId=antlr \
    -Dversion=4.5.1 \
    -Dpackaging=jar

# BioJava core
mvn install:install-file \
    -Dfile=biojava3-core-3.0.7.jar \
    -DgroupId=org.biojava \
    -DartifactId=biojava3-core \
    -Dversion=3.0.7 \
    -Dpackaging=jar

# BioJava structure
mvn install:install-file \
    -Dfile=biojava3-structure-3.0.7.jar \
    -DgroupId=org.biojava \
    -DartifactId=biojava3-structure \
    -Dversion=3.0.7 \
    -Dpackaging=jar

cd -

# SnpSift
git clone https://github.com/pcingola/SnpSift.git
cd SnpSift
mvn package
mvn install
</code></pre>
<p>which gives <code>target/SnpEff-4.3.jar</code> and <code>target/SnpSift-4.3.jar</code>, respectively.</p>
<p>Note that <code>antlr4</code> is from GitHub, https://github.com/antlr/antlr4. See also https://github.com/sanger-pathogens/SnpEffWrapper.</p>
<h2 id="subread">subread</h2>
<p>It is available from http://subread.sourceforge.net/.</p>
<h2 id="svict">SViCT</h2>
<p>Short for Structural Variant detrction in Circulating Tumor DNA and is available from</p>
<p>https://github.com/vpc-ccg/svict</p>
<h2 id="tagdust">tagdust</h2>
<p>http://sourceforge.net/projects/tagdust/</p>
<h2 id="trinity">Trinity</h2>
<p>RNA-Seq De novo Assembly Using Trinity, https://github.com/trinityrnaseq/trinityrnaseq/wiki.</p>
<h2 id="varscan">VarScan</h2>
<p>Hosted at https://github.com/dkoboldt/varscan, the .jar files are ready to use with</p>
<pre><code class="language-bash">git clone https://github.com/dkoboldt/varscan
</code></pre>
<p>or from the repository releases.</p>
<p>See http://varscan.sourceforge.net/ for further information.</p>
<h2 id="vcftools">vcftools</h2>
<p>Assuming that we use zlib 1.2.8 from module zlib/1.2.8, we can do the following,</p>
<pre><code class="language-bash">wget https://github.com/vcftools/vcftools/releases/download/v0.1.16/vcftools-0.1.16.tar.gz
tar xvfz vcftools-0.1.16.tar.gz
module load zlib/1.2.8
./configure --prefix=/scratch/jhz22 ZLIB_CFLAGS=&quot;-I/usr/local/Cluster-Apps/zlib/1.2.8/include&quot; ZLIB_LIBS=&quot;-L/usr/local/Cluster-Apps/zlib/1.2.8/lib -lz&quot;
make
make install
</code></pre>
<p>To use vcf-concat, it is necessary to set the PERL5LIB environment variables, e.g.,</p>
<pre><code class="language-bash">export PERL5LIB=/scratch/jhz22/share/perl5
</code></pre>
<h2 id="wasp">WASP</h2>
<p>Allele-specific pipeline for unbiased read mapping and molecular QTL discovery, https://github.com/bmvdgeijn/WASP/.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js" defer></script>
        <script src="../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
